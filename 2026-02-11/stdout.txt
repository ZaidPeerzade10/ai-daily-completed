--- 1. Generating Synthetic Data ---
Generated 602 users.
Generated 5917 sessions.
Users head:
    user_id signup_date region initial_plan_type  churn_risk_score
0        0  2020-01-11   East           Premium          0.680228
1        1  2019-07-30  South              Free          0.072198
2        2  2019-02-16  North           Premium          0.030653
3        3  2019-01-12   West             Basic          0.257683
4        4  2020-10-02  South              Free          0.462623
Sessions head:
    session_id  user_id session_start_time  duration_minutes  num_pages_viewed
0           0        0         2021-11-04         69.617910                17
1           1        0         2023-02-16         43.270727                 5
2           2        0         2023-01-14         59.537348                 5
3           3        0         2021-07-05         69.061743                10
4           4        0         2023-09-09         37.974039                 8

--- 2. Loading into SQLite & SQL Feature Engineering ---
Global Analysis Date: 2023-11-30
Feature Cutoff Date: 2023-10-01
User features DataFrame head (from SQL):
    user_id  ... days_since_last_session_pre_cutoff
0        0  ...                               22.0
1        1  ...                              101.0
2        2  ...                               63.0
3        3  ...                               82.0
4        4  ...                               78.0

[5 rows x 8 columns]
Number of users in features DF: 602

--- 3. Pandas Feature Engineering & Binary Target Creation ---
User features DataFrame with target:
    user_id region  ... account_age_at_cutoff_days is_churned_future
0        0   East  ...                       1359                 1
1        1  South  ...                       1524                 0
2        2  North  ...                       1688                 1
3        3   West  ...                       1723                 0
4        4  South  ...                       1094                 0

[5 rows x 10 columns]
Churn status distribution:
 is_churned_future
1    0.818937
0    0.181063
Name: proportion, dtype: float64

X_train shape: (421, 7), y_train shape: (421,)
X_test shape: (181, 7), y_test shape: (181,)

--- 4. Data Visualization ---

--- 5. ML Pipeline & Evaluation (Binary Classification) ---
Training the ML pipeline...
Pipeline trained.

ROC AUC Score on Test Set: 0.6810

Classification Report on Test Set:
              precision    recall  f1-score   support

           0       0.29      0.15      0.20        33
           1       0.83      0.92      0.87       148

    accuracy                           0.78       181
   macro avg       0.56      0.54      0.54       181
weighted avg       0.73      0.78      0.75       181


--- Script Finished ---
