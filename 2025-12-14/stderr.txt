Traceback (most recent call last):
  File "/home/runner/work/ai-daily-runner/ai-daily-runner/workspace/2025-12-14/solution_attempt_3.py", line 92, in <module>
    main()
  File "/home/runner/work/ai-daily-runner/ai-daily-runner/workspace/2025-12-14/solution_attempt_3.py", line 57, in main
    df['customer_30d_avg_spend'] = df.groupby('customer_id')['amount'].transform(
  File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pandas/core/groupby/generic.py", line 517, in transform
    return self._transform(
  File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pandas/core/groupby/groupby.py", line 2028, in _transform
    return self._transform_general(func, engine, engine_kwargs, *args, **kwargs)
  File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pandas/core/groupby/generic.py", line 557, in _transform_general
    res = func(group, *args, **kwargs)
  File "/home/runner/work/ai-daily-runner/ai-daily-runner/workspace/2025-12-14/solution_attempt_3.py", line 58, in <lambda>
    lambda x: x.rolling(window='30D', on=df.loc[x.index, 'transaction_date']).mean()
  File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pandas/core/generic.py", line 12645, in rolling
    return Rolling(
  File "/opt/hostedtoolcache/Python/3.10.19/x64/lib/python3.10/site-packages/pandas/core/window/rolling.py", line 164, in __init__
    raise ValueError(
ValueError: invalid on specified as 0      2024-12-14 04:56:27.982604
1      2024-12-14 04:56:27.982604
2      2024-12-14 04:56:27.982604
3      2024-12-14 04:56:27.982604
4      2024-12-14 04:56:27.982604
                  ...            
1455   2025-12-12 04:56:27.982604
1456   2025-12-13 04:56:27.982604
1457   2025-12-13 04:56:27.982604
1458   2025-12-13 04:56:27.982604
1459   2025-12-13 04:56:27.982604
Name: transaction_date, Length: 1460, dtype: datetime64[ns], must be a column (of DataFrame), an Index or None
